name: Test

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        os:
          - 'ubuntu-20.04'
        python-version:
          - '3.8'
        arch:
          - 'x86_64'
    steps:
    - uses: actions/checkout@v2
    - name: Set up Python 3.8
      uses: actions/setup-python@v2
      with:
        python-version: 3.8
        
    - name: Install Dependencies 
      run: |
        pip install --upgrade setuptools
        python -m pip install --upgrade pip
        sudo apt-get install -y --no-install-recommends freetds-bin krb5-user ldap-utils libsasl2-2 libsasl2-modules libssl1.1 locales lsb-release sasl2-bin sqlite3 unixodbc
        python setup.py install
        pip install --upgrade google-cloud-storage
        pip install --force-reinstall python-telegram-bot
        pip install apache-airflow pytest freezegun filelock celery
        pip install jira jenkins JayDeBeApi analytics google-cloud-bigquery 
        pip install PySmbClient arrow pdpyras papermill cx-Oracle opsgenie-sdk neo4j  PyMongo pywinrm pypsrp 
        pip install kubernetes cachetools smbprotocol future boto3
        pip install moto apache-airflow-breeze parameterized sentry-sdk
        pip install statsd psycopg2-binary requests-mock
        pip install oss2 google-api-core docker watchtower mypy-boto3-rds
        pip install cassandra-driver sqlparse pydruid hdfs
        pip install pandas google-api-python-client bson paramiko
        pip install asana cloudant databricks datadog elasticsearch
        pip install kylinpy pinotdb pyspark python-arango 
        pip install PyGithub httplib2 presto-python-client zenpy
        pip install vertica-python telegram tableauserverclient sshtunnel
        pip install snowflake slack-sdk pysftp sendgrid spython trino
        pip install yandexcloud cgroupspy bs4 grpcio redshift-connector 
        pip install jsonpath-ng pyexasol facebook-business qds_sdk simple-salesforce plyvel
        pip install pandas-gbq google-cloud-secret-manager google-cloud-redis devtools 
        pip install google-cloud-bigtable google-cloud-bigquery-datatransfer google-cloud-logging 
        pip install google-cloud-container looker-sdk google-cloud-language 
        pip install google-cloud-orchestration-airflow google-cloud-os-login 
        pip install google-cloud-workflows google-cloud-automl
        pip install google-cloud-videointelligence google-cloud-datacatalog 
        pip install google-cloud-dataproc-metastore google-cloud-kms elasticsearch_dsl  
        pip install arango hmsclient azure-storage-blob sqlalchemy-databricks google-ads 
        pip install docker distributed google-cloud-dlp
        pip install influxdb-client hvac azure-mgmt-datafactory azure-cosmos
        sudo apt install -y libkrb5-dev
        pip install azureml-sdk kerberos gapic-google-cloud-spanner-v1 
        pip install cassandra-driver sqlalchemy-databricks azure-keyvault
        sudo apt install unixodbc-dev --yes && pip install pyodbc azure-mgmt-containerinstance azure-batch
        sudo apt-get install -y python3-dev default-libmysqlclient-dev build-essential
        pip install mysqlclient azure-datalake-store    
        pip install proto-google-cloud-language-v1 google-cloud-pubsub google-cloud-speech 
        
    - name: test      
      run: |
       python -m pytest

